{"ast":null,"code":"/**\r\n * Copyright 2018 Google Inc. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\"use strict\";\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\"; // Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAwcnfyJDrxYTVGnbGJ39pwyRPmbbln8jI\",\n  authDomain: \"tabulate-da8ac.firebaseapp.com\",\n  projectId: \"tabulate-da8ac\",\n  storageBucket: \"tabulate-da8ac.appspot.com\",\n  messagingSenderId: \"600957298630\",\n  appId: \"1:600957298630:web:8dff818513beaf9c9734c7\",\n  measurementId: \"G-FRRT9SB5QF\"\n}; // Initialize Firebase\n\nfirebase.initializeApp(firebaseConfig);\nconsole.log(firebase);\nexport const auth = firebase.auth(); // Signs-in to TabUlate.\n\nexport function signIn() {\n  // TODO 1: Sign in Firebase with credential from the Google user.\n  // Sign into Firebase using popup auth & Google as the identity provider.\n  let provider = new firebase.auth.GoogleAuthProvider();\n  firebase.auth().signInWithPopup(provider).then(() => {\n    let user = firebase.firestore().collection(\"users\").doc(getUserName());\n    user.get().then(doc => {\n      if (!doc.exists) {\n        user.set({\n          name: getUserName(),\n          widgets: [],\n          // do this at sign-in\n          timestamp: firebase.firestore.FieldValue.serverTimestamp()\n        }).catch(function (error) {\n          console.error(\"Error writing new message to database\", error);\n        });\n      }\n    });\n  }).catch(function (error) {\n    console.error(\"Error signing in\", error);\n  });\n} // Signs-out of TabUlate.\n\nexport function signOut() {\n  firebase.auth().signOut();\n} // Initiate firebase auth.\n// export function initFirebaseAuth() {\n//   // TODO 3: Initialize Firebase.\n//   firebase.auth().onAuthStateChanged(authStateObserver);\n// }\n// Returns the signed-in user's profile Pic URL.\n\nexport function getProfilePicUrl() {\n  return firebase.auth().currentUser.photoURL || \"https://lh3.googleusercontent.com/-5NpIVUCd2lE/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmn22K-OnZPInLvX19yR_TVKiUFCA/s96-c/photo.jpg\";\n} // Returns the signed-in user's display name.\n\nexport function getUserName() {\n  return firebase.auth().currentUser.displayName;\n} // Returns true if a user is signed-in.\n\nexport function isUserSignedIn() {\n  return !!firebase.auth().currentUser;\n}\nexport function addWidget(widgetTitle) {\n  // Add a new message entry to the database.\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\n  console.log(\"78\", user);\n\n  if (user) {\n    user.get().then(doc => {\n      let tempWidgets = doc.data().widgets;\n      return tempWidgets;\n    }).then(tempWidgets => {\n      console.log(\"70\", tempWidgets);\n      tempWidgets.push({\n        title: widgetTitle,\n        links: []\n      });\n      console.log(\"73\", tempWidgets);\n      return user.update({\n        name: getUserName(),\n        widgets: tempWidgets,\n        timestamp: firebase.firestore.FieldValue.serverTimestamp()\n      }, {\n        merge: true\n      }).catch(function (error) {\n        console.error(\"Error writing new message to database\", error);\n      });\n    });\n  }\n} // const getWidgetsPromise = new Promise((user) => {\n//   user.get().then((doc) => {\n//     if (doc.exists) {\n//       console.log(\"doc exists\");\n//       console.log(doc.data().widgets);\n//       return doc.data().widgets;\n//     } else {\n//       console.log(\"doc doesn't exit\");\n//     }\n//   });\n// });\n\nexport function getWidgets() {\n  // returns the current user's widgets\n  return new Promise(() => {\n    let user = firebase.firestore().collection(\"users\").doc(getUserName());\n    console.log(\"firebase:\", user);\n    user.get().then(doc => {\n      if (doc.exists) {\n        console.log(\"doc exists\", doc.data().widgets);\n        return doc.data().widgets;\n      } else {\n        console.log(\"doc doesn't exit\");\n      }\n    });\n  });\n}\nexport function addLinkToWidget(widgetName, website, url) {\n  // Add a new message entry to the database.\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\n  let tempWidgets = [\"check this\"];\n  console.log(\"92\");\n  user.get().then(doc => {\n    console.log(\"96\", doc.data());\n    tempWidgets = doc.data().widgets;\n    console.log(\"98\", tempWidgets);\n    const toEdit = tempWidgets.find(obj => {\n      return obj.title === widgetName;\n    });\n    console.log(\"103\", toEdit);\n    toEdit.links.push({\n      url: url,\n      name: website\n    });\n    tempWidgets.map(obj => obj);\n    console.log(\"108\", toEdit);\n    console.log(\"109\", tempWidgets);\n  }).then(() => {\n    console.log(\"111\", tempWidgets);\n    return user.update({\n      name: getUserName(),\n      //widgets: [{widgetTitle: \"bruh\", links: [{linkName : url}, {}, {}]}],\n      widgets: tempWidgets,\n      timestamp: firebase.firestore.FieldValue.serverTimestamp()\n    }, {\n      merge: true\n    }).catch(function (error) {\n      console.error(\"Error writing new message to database\", error);\n    });\n  }).catch(error => {\n    console.log(\"Error getting document:\", error);\n  });\n}\nexport function deleteLink(widgetName, url) {\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\n  user.get().then(doc => {\n    if (doc.exists) {\n      console.log(\"doc exists\");\n      console.log(doc.data().widgets);\n      return doc.data().widgets;\n    } else {\n      console.log(\"doc doesn't exit\");\n    }\n  }).then(widgets => {\n    let widget = widgets.find(obj => {\n      return obj.title == widgetName;\n    });\n    widget.links = widget.links.filter(obj => {\n      return obj.url !== url;\n    });\n    user.update({\n      name: getUserName(),\n      widgets: widgets,\n      timestamp: firebase.firestore.FieldValue.serverTimestamp()\n    }, {\n      merge: true\n    }).catch(function (error) {\n      console.error(\"Error writing new message to database\", error);\n    });\n  });\n}\nexport function deleteWidget(widgetName) {\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\n  user.get().then(doc => {\n    if (doc.exists) {\n      console.log(\"doc exists\");\n      console.log(doc.data().widgets);\n      return doc.data().widgets;\n    } else {\n      console.log(\"doc doesn't exit\");\n    }\n  }).then(widgets => {\n    console.log(\"216 \" + widgets);\n    const newState = widgets.filter(obj => {\n      return obj.title !== widgetName;\n    });\n    user.update({\n      name: getUserName(),\n      widgets: newState,\n      timestamp: firebase.firestore.FieldValue.serverTimestamp()\n    }, {\n      merge: true\n    }).catch(function (error) {\n      console.error(\"Error writing new message to database\", error);\n    });\n  }); // getWidgetsPromise.then(user)\n  //   console.log(\"216 \" + widgets);\n  //   const newState = widgets.filter((obj) => {\n  //     return obj.title !== widgetName;\n  //   });\n  //   user\n  //     .update(\n  //       {\n  //         name: getUserName(),\n  //         widgets: newState,\n  //         timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n  //       },\n  //       { merge: true }\n  //     )\n  //     .catch(function (error) {\n  //       console.error(\"Error writing new message to database\", error);\n  //     });\n  // get the widget with title=widgetName\n} // Loads chat messages history and listens for upcoming ones.\n// Returns true if user is signed-in. Otherwise false and displays a message.\n\nexport function checkSignedInWithMessage() {\n  // Return true if the user is signed in Firebase\n  if (isUserSignedIn()) {\n    return true;\n  }\n} // Resets the given MaterialTextField.\n\nexport function resetMaterialTextfield(element) {\n  element.value = \"\";\n  element.parentNode.MaterialTextfield.boundUpdateClassesHandler();\n} // Checks that the Firebase SDK has been correctly setup and configured.\n\nexport function checkSetup() {\n  if (!window.firebase || !(firebase.app instanceof Function) || !firebase.app().options) {\n    window.alert(\"You have not configured and imported the Firebase SDK. \" + \"Make sure you go through the codelab setup instructions and make \" + \"sure you are running the codelab using `firebase serve`\");\n  }\n}\ncheckSetup(); // initialize Firebase\n// initFirebaseAuth();\n// TODO: Enable Firebase Performance Monitoring.\n// We load currently existing chat messages and listen to new ones.\n\nexport function bruh() {\n  console.log(\"have a wonderful day!\");\n}","map":{"version":3,"sources":["C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/src/scripts/login.js"],"names":["firebase","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","initializeApp","console","log","auth","signIn","provider","GoogleAuthProvider","signInWithPopup","then","user","firestore","collection","doc","getUserName","get","exists","set","name","widgets","timestamp","FieldValue","serverTimestamp","catch","error","signOut","getProfilePicUrl","currentUser","photoURL","displayName","isUserSignedIn","addWidget","widgetTitle","tempWidgets","data","push","title","links","update","merge","getWidgets","Promise","addLinkToWidget","widgetName","website","url","toEdit","find","obj","map","deleteLink","widget","filter","deleteWidget","newState","checkSignedInWithMessage","resetMaterialTextfield","element","value","parentNode","MaterialTextfield","boundUpdateClassesHandler","checkSetup","window","app","Function","options","alert","bruh"],"mappings":"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","sourcesContent":["/**\r\n * Copyright 2018 Google Inc. All Rights Reserved.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\"use strict\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/firestore\";\r\n\r\n// Your web app's Firebase configuration\r\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAwcnfyJDrxYTVGnbGJ39pwyRPmbbln8jI\",\r\n  authDomain: \"tabulate-da8ac.firebaseapp.com\",\r\n  projectId: \"tabulate-da8ac\",\r\n  storageBucket: \"tabulate-da8ac.appspot.com\",\r\n  messagingSenderId: \"600957298630\",\r\n  appId: \"1:600957298630:web:8dff818513beaf9c9734c7\",\r\n  measurementId: \"G-FRRT9SB5QF\",\r\n};\r\n// Initialize Firebase\r\nfirebase.initializeApp(firebaseConfig);\r\nconsole.log(firebase);\r\n\r\nexport const auth = firebase.auth();\r\n\r\n// Signs-in to TabUlate.\r\nexport function signIn() {\r\n  // TODO 1: Sign in Firebase with credential from the Google user.\r\n  // Sign into Firebase using popup auth & Google as the identity provider.\r\n    let provider = new firebase.auth.GoogleAuthProvider();\r\n    firebase\r\n      .auth()\r\n      .signInWithPopup(provider)\r\n      .then(() => {\r\n        let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n        user.get().then((doc) => {\r\n          if (!doc.exists) {\r\n            user\r\n              .set({\r\n                name: getUserName(),\r\n                widgets: [], // do this at sign-in\r\n                timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n              })\r\n              .catch(function (error) {\r\n                console.error(\"Error writing new message to database\", error);\r\n              });\r\n          }\r\n        });\r\n      }).catch(function (error) {\r\n        console.error(\"Error signing in\", error);\r\n      });\r\n}\r\n\r\n// Signs-out of TabUlate.\r\nexport function signOut() {\r\n  firebase.auth().signOut();\r\n}\r\n\r\n// Initiate firebase auth.\r\n// export function initFirebaseAuth() {\r\n//   // TODO 3: Initialize Firebase.\r\n//   firebase.auth().onAuthStateChanged(authStateObserver);\r\n// }\r\n\r\n// Returns the signed-in user's profile Pic URL.\r\nexport function getProfilePicUrl() {\r\n  return (\r\n    firebase.auth().currentUser.photoURL ||\r\n    \"https://lh3.googleusercontent.com/-5NpIVUCd2lE/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmn22K-OnZPInLvX19yR_TVKiUFCA/s96-c/photo.jpg\"\r\n  );\r\n}\r\n\r\n// Returns the signed-in user's display name.\r\nexport function getUserName() {\r\n  return firebase.auth().currentUser.displayName;\r\n}\r\n\r\n// Returns true if a user is signed-in.\r\nexport function isUserSignedIn() {\r\n  return !!firebase.auth().currentUser;\r\n}\r\n\r\nexport function addWidget(widgetTitle) {\r\n  // Add a new message entry to the database.\r\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n  console.log(\"78\", user);\r\n\r\n  if (user) {\r\n    user\r\n      .get()\r\n      .then((doc) => {\r\n        let tempWidgets = doc.data().widgets;\r\n        return tempWidgets;\r\n      })\r\n      .then((tempWidgets) => {\r\n        console.log(\"70\", tempWidgets);\r\n        tempWidgets.push({ title: widgetTitle, links: [] });\r\n        console.log(\"73\", tempWidgets);\r\n\r\n        return user\r\n          .update(\r\n            {\r\n              name: getUserName(),\r\n              widgets: tempWidgets,\r\n              timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n            },\r\n            { merge: true }\r\n          )\r\n          .catch(function (error) {\r\n            console.error(\"Error writing new message to database\", error);\r\n          });\r\n      });\r\n  }\r\n}\r\n\r\n// const getWidgetsPromise = new Promise((user) => {\r\n//   user.get().then((doc) => {\r\n//     if (doc.exists) {\r\n//       console.log(\"doc exists\");\r\n//       console.log(doc.data().widgets);\r\n//       return doc.data().widgets;\r\n//     } else {\r\n//       console.log(\"doc doesn't exit\");\r\n//     }\r\n//   });\r\n// });\r\n\r\nexport function getWidgets() {\r\n  // returns the current user's widgets\r\n\r\n  return new Promise(() => {\r\n    let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n    console.log(\"firebase:\", user)\r\n    user.get().then((doc) => {\r\n      if (doc.exists) {\r\n        console.log(\"doc exists\", doc.data().widgets);\r\n        return doc.data().widgets;\r\n      } else {\r\n        console.log(\"doc doesn't exit\");\r\n      }\r\n    });\r\n  })\r\n\r\n  \r\n}\r\n\r\nexport function addLinkToWidget(widgetName, website, url) {\r\n  // Add a new message entry to the database.\r\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n\r\n  let tempWidgets = [\"check this\"];\r\n  console.log(\"92\");\r\n\r\n  user\r\n    .get()\r\n    .then((doc) => {\r\n      console.log(\"96\", doc.data());\r\n      tempWidgets = doc.data().widgets;\r\n      console.log(\"98\", tempWidgets);\r\n\r\n      const toEdit = tempWidgets.find((obj) => {\r\n        return obj.title === widgetName;\r\n      });\r\n      console.log(\"103\", toEdit);\r\n\r\n      toEdit.links.push({ url: url, name: website });\r\n      tempWidgets.map((obj) => obj);\r\n      console.log(\"108\", toEdit);\r\n      console.log(\"109\", tempWidgets);\r\n    })\r\n    .then(() => {\r\n      console.log(\"111\", tempWidgets);\r\n\r\n      return user\r\n        .update(\r\n          {\r\n            name: getUserName(),\r\n            //widgets: [{widgetTitle: \"bruh\", links: [{linkName : url}, {}, {}]}],\r\n            widgets: tempWidgets,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n          },\r\n          { merge: true }\r\n        )\r\n        .catch(function (error) {\r\n          console.error(\"Error writing new message to database\", error);\r\n        });\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"Error getting document:\", error);\r\n    });\r\n}\r\n\r\nexport function deleteLink(widgetName, url) {\r\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n\r\n  user\r\n    .get()\r\n    .then((doc) => {\r\n      if (doc.exists) {\r\n        console.log(\"doc exists\");\r\n        console.log(doc.data().widgets);\r\n        return doc.data().widgets;\r\n      } else {\r\n        console.log(\"doc doesn't exit\");\r\n      }\r\n    })\r\n    .then((widgets) => {\r\n      let widget = widgets.find((obj) => {\r\n        return obj.title == widgetName;\r\n      });\r\n      widget.links = widget.links.filter((obj) => {\r\n        return obj.url !== url;\r\n      });\r\n\r\n      user\r\n        .update(\r\n          {\r\n            name: getUserName(),\r\n            widgets: widgets,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n          },\r\n          { merge: true }\r\n        )\r\n        .catch(function (error) {\r\n          console.error(\"Error writing new message to database\", error);\r\n        });\r\n    });\r\n}\r\n\r\nexport function deleteWidget(widgetName) {\r\n  let user = firebase.firestore().collection(\"users\").doc(getUserName());\r\n\r\n  user\r\n    .get()\r\n    .then((doc) => {\r\n      if (doc.exists) {\r\n        console.log(\"doc exists\");\r\n        console.log(doc.data().widgets);\r\n        return doc.data().widgets;\r\n      } else {\r\n        console.log(\"doc doesn't exit\");\r\n      }\r\n    })\r\n    .then((widgets) => {\r\n      console.log(\"216 \" + widgets);\r\n      const newState = widgets.filter((obj) => {\r\n        return obj.title !== widgetName;\r\n      });\r\n\r\n      user\r\n        .update(\r\n          {\r\n            name: getUserName(),\r\n            widgets: newState,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n          },\r\n          { merge: true }\r\n        )\r\n        .catch(function (error) {\r\n          console.error(\"Error writing new message to database\", error);\r\n        });\r\n    });\r\n\r\n  // getWidgetsPromise.then(user)\r\n  //   console.log(\"216 \" + widgets);\r\n  //   const newState = widgets.filter((obj) => {\r\n  //     return obj.title !== widgetName;\r\n  //   });\r\n\r\n  //   user\r\n  //     .update(\r\n  //       {\r\n  //         name: getUserName(),\r\n  //         widgets: newState,\r\n  //         timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n  //       },\r\n  //       { merge: true }\r\n  //     )\r\n  //     .catch(function (error) {\r\n  //       console.error(\"Error writing new message to database\", error);\r\n  //     });\r\n  // get the widget with title=widgetName\r\n}\r\n\r\n// Loads chat messages history and listens for upcoming ones.\r\n\r\n// Returns true if user is signed-in. Otherwise false and displays a message.\r\nexport function checkSignedInWithMessage() {\r\n  // Return true if the user is signed in Firebase\r\n  if (isUserSignedIn()) {\r\n    return true;\r\n  }\r\n}\r\n// Resets the given MaterialTextField.\r\nexport function resetMaterialTextfield(element) {\r\n  element.value = \"\";\r\n  element.parentNode.MaterialTextfield.boundUpdateClassesHandler();\r\n}\r\n\r\n// Checks that the Firebase SDK has been correctly setup and configured.\r\nexport function checkSetup() {\r\n  if (\r\n    !window.firebase ||\r\n    !(firebase.app instanceof Function) ||\r\n    !firebase.app().options\r\n  ) {\r\n    window.alert(\r\n      \"You have not configured and imported the Firebase SDK. \" +\r\n        \"Make sure you go through the codelab setup instructions and make \" +\r\n        \"sure you are running the codelab using `firebase serve`\"\r\n    );\r\n  }\r\n}\r\ncheckSetup();\r\n\r\n// initialize Firebase\r\n// initFirebaseAuth();\r\n\r\n// TODO: Enable Firebase Performance Monitoring.\r\n\r\n// We load currently existing chat messages and listen to new ones.\r\n\r\nexport function bruh() {\r\n  console.log(\"have a wonderful day!\");\r\n}\r\n"]},"metadata":{},"sourceType":"module"}