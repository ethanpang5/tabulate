{"ast":null,"code":"import _defineProperty from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*global chrome*/import React,{useState,useEffect,useContext}from\"react\";import{Modal,Button,Form}from\"react-bootstrap\";import Widget from\"./Widget\";import AddWidgetModal from\"./AddWidgetModal\";import{addWidget as addWidgetFirebase,deleteWidget as deleteWidgetFirebase,getWidgets as getWidgetsFirebase,addLinkToWidget as addLinkFirebase,changeWidgetTitle as changeWidgetTitleFirebase,deleteLink as deleteLinkFirebase,db}from\"../scripts/login.js\";import{UserContext}from\"../providers/UserProvider\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function MyVerticallyCenteredModal(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),website=_useState2[0],setWebsite=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),url=_useState4[0],setUrl=_useState4[1];var onHide=function onHide(){props.onHide();setWebsite(\"\");setUrl(\"\");};var onSubmit=function onSubmit(e){e.preventDefault();// console.log(website, url, props.currWidget);\nonHide();props.addLinkToWidget(website,url,props.currWidget);};return/*#__PURE__*/_jsxs(Modal,_objectSpread(_objectSpread({},props),{},{onHide:onHide,size:\"lg\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsxs(Modal.Title,{id:\"contained-modal-title-vcenter\",children:[\"Add to \",props.currWidget]})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"websiteName\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Website name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"\",value:website,onChange:function onChange(e){return setWebsite(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"url\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"URL\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"\",value:url,onChange:function onChange(e){return setUrl(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Save\"})]})})]}));}var Dashboard=function Dashboard(){var _user$email,_jsx2;var user=useContext(UserContext);var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),modalShow=_React$useState2[0],setModalShow=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),currWidget=_React$useState4[0],setCurrWidget=_React$useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showWidgetModal=_useState6[0],setShowWidgetModal=_useState6[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),widgets=_React$useState6[0],setWidgets=_React$useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),recents=_useState8[0],setRecents=_useState8[1];// const [widgets, setWidgets] = React.useState([\n//   {\n//     title: \"Classes\",\n//     links: [\n//       { url: \"sp21.datastructur.es\", name: \"CS61B\" },\n//       {\n//         url:\n//           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\n//         name: \"Cubstart\",\n//       },\n//       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\n//     ],\n//   },\n//   {\n//     title: \"Favorites\",\n//     links: [\n//       { url: \"sp21.datastructur.es\", name: \"weird link\" },\n//       {\n//         url:\n//           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\n//         name: \"Cubstart\",\n//       },\n//       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\n//     ],\n//   },\n// ]);\n// const [recents, setRecents] = useState([\n//   {\n//     title: \"Youtube\",\n//     url: \"https://www.youtube.com\",\n//   },\n//   {\n//     title:\n//       \"Netflix test test test test test test test test test test test test test test test test test test test test test test test test test test\",\n//     url: \"https://www.netflix.com\",\n//   },\n//   {\n//     title: \"Google\",\n//     url: \"https://www.google.com\",\n//   },\n// ]);\n//UNCOMMENT FOR CHROME EXTENSION\nuseEffect(function(){chrome.history.search({text:\"\",maxResults:20},function(data){var updated=[];data.forEach(function(page){if(page.title){updated.push({title:page.title,url:page.url});}});setRecents(updated);});},[]);var userEmail=user===null||user===void 0?void 0:(_user$email=user.email)===null||_user$email===void 0?void 0:_user$email.replace(\"@\",\"%40\");//\"charlesming2002%40gmail.com\"\nvar fetchWidgets=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var response,data,w;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:response=db.collection(\"users\").doc(user.displayName);_context.next=3;return response.get();case 3:data=_context.sent;_context.next=6;return data.data().widgets;case 6:w=_context.sent;setWidgets(w);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchWidgets(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(user){fetchWidgets(user);}},[user]);var addLinkToWidget=function addLinkToWidget(website,url,widgetName){var toEdit=widgets.find(function(obj){return obj.title===widgetName;});console.log(\"159\",widgets,toEdit);if(!url.startsWith(\"https://\")){url=\"https://\"+url;}toEdit.links.push({url:url,name:website});var newState=widgets.map(function(obj){return obj;});setWidgets(newState);addLinkFirebase(widgetName,website,url);//sync firebase\n};var removeLinkFromWidget=function removeLinkFromWidget(widgetName,url){var widget=widgets.find(function(obj){return obj.title===widgetName;});widget.links=widget.links.filter(function(obj){return obj.url!==url;});var newState=widgets.map(function(obj){return obj;});setWidgets(newState);deleteLinkFirebase(widgetName,url);//sync firebase\n};var openModal=function openModal(widgetName){setModalShow(true);setCurrWidget(widgetName);//sync firebase\n};var openWidgetModal=function openWidgetModal(){setShowWidgetModal(true);};var addWidgetToDashboard=function addWidgetToDashboard(title){var old=widgets.map(function(obj){return obj;});old.push({title:title,links:[]});setWidgets(old);addWidgetFirebase(title);//sync firebase\n};var deleteWidget=function deleteWidget(widgetName){var newState=widgets.filter(function(obj){return obj.title!==widgetName;});setWidgets(newState);deleteWidgetFirebase(widgetName);};var changeWidgetTitle=function changeWidgetTitle(widgetName,newWidgetTitle){var widget=widgets.find(function(obj){return obj.title===widgetName;});widget.title=newWidgetTitle;var newState=widgets.map(function(obj){return obj;});setWidgets(newState);changeWidgetTitleFirebase(widgetName,newWidgetTitle);};return/*#__PURE__*/_jsx(_Fragment,{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-grid\",children:widgets.map(function(widget){return/*#__PURE__*/_jsx(Widget,{title:widget.title,links:widget.links,openModal:openModal,removeLink:removeLinkFromWidget,deleteWidget:deleteWidget,changeWidgetTitle:changeWidgetTitle,isActive:currWidget===widget.title,onClick:function onClick(){setCurrWidget(widget.title);}});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-grid2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"widget2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"widget-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"widget-title\",children:\"Recents\"}),/*#__PURE__*/_jsx(\"div\",{className:\"widget-control\",children:/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-secondary btn-sm action-button\",onClick:function onClick(){chrome.history.search({text:\"\",maxResults:20},function(data){var updated=[];data.forEach(function(page){if(page.title){updated.push({title:page.title,url:page.url});}});setRecents(updated);});},children:\"refresh\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"widget-grid\",id:\"recents\",children:recents.map(function(recent){return/*#__PURE__*/_jsxs(\"div\",{className:\"widget-link\",children:[/*#__PURE__*/_jsx(\"a\",{href:recent.url,target:\"_blank\",className:\"classes-link\",children:recent.title}),currWidget?/*#__PURE__*/_jsx(\"button\",{class:\"btn btn-success btn-xs\",onClick:function onClick(){if(currWidget){addLinkToWidget(recent.title,recent.url,currWidget);}},children:\"+\"}):null]});})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"widget2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"widget-header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"widget-title\",children:\"Calendar\"})}),/*#__PURE__*/_jsx(\"iframe\",{src:\"https://www.google.com/calendar/embed?src=\"+userEmail+\"&ctz=America%2FLos_Angeles\",title:\"calendar\",width:\"600\",height:\"400\",frameborder:\"0\",scrolling:\"no\"})]})]}),/*#__PURE__*/_jsx(\"div\",{class:\"addWidgetContainer\",children:/*#__PURE__*/_jsx(\"button\",(_jsx2={class:\"addWidgetButton\",type:\"button\"},_defineProperty(_jsx2,\"class\",\"btn btn-primary\"),_defineProperty(_jsx2,\"onClick\",function onClick(){return openWidgetModal();}),_defineProperty(_jsx2,\"children\",\"Add widget\"),_jsx2))}),/*#__PURE__*/_jsx(MyVerticallyCenteredModal,{show:modalShow,onHide:function onHide(){return setModalShow(false);},currWidget:currWidget,addLinkToWidget:addLinkToWidget}),/*#__PURE__*/_jsx(AddWidgetModal,{show:showWidgetModal,onHide:function onHide(){return setShowWidgetModal(false);},addWidgetToDashboard:addWidgetToDashboard})]}):/*#__PURE__*/_jsx(_Fragment,{})});};export default Dashboard;","map":{"version":3,"sources":["C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/src/components/Dashboard.js"],"names":["React","useState","useEffect","useContext","Modal","Button","Form","Widget","AddWidgetModal","addWidget","addWidgetFirebase","deleteWidget","deleteWidgetFirebase","getWidgets","getWidgetsFirebase","addLinkToWidget","addLinkFirebase","changeWidgetTitle","changeWidgetTitleFirebase","deleteLink","deleteLinkFirebase","db","UserContext","MyVerticallyCenteredModal","props","website","setWebsite","url","setUrl","onHide","onSubmit","e","preventDefault","currWidget","target","value","Dashboard","user","modalShow","setModalShow","setCurrWidget","showWidgetModal","setShowWidgetModal","widgets","setWidgets","recents","setRecents","chrome","history","search","text","maxResults","data","updated","forEach","page","title","push","userEmail","email","replace","fetchWidgets","response","collection","doc","displayName","get","w","widgetName","toEdit","find","obj","console","log","startsWith","links","name","newState","map","removeLinkFromWidget","widget","filter","openModal","openWidgetModal","addWidgetToDashboard","old","newWidgetTitle","recent"],"mappings":"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","sourcesContent":["/*global chrome*/\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport { Modal, Button, Form } from \"react-bootstrap\";\r\n\r\nimport Widget from \"./Widget\";\r\nimport AddWidgetModal from \"./AddWidgetModal\";\r\nimport {\r\n  addWidget as addWidgetFirebase,\r\n  deleteWidget as deleteWidgetFirebase,\r\n  getWidgets as getWidgetsFirebase,\r\n  addLinkToWidget as addLinkFirebase,\r\n  changeWidgetTitle as changeWidgetTitleFirebase,\r\n  deleteLink as deleteLinkFirebase,\r\n  db,\r\n} from \"../scripts/login.js\";\r\nimport { UserContext } from \"../providers/UserProvider\";\r\n\r\nfunction MyVerticallyCenteredModal(props) {\r\n  const [website, setWebsite] = useState(\"\");\r\n  const [url, setUrl] = useState(\"\");\r\n\r\n  const onHide = () => {\r\n    props.onHide();\r\n    setWebsite(\"\");\r\n    setUrl(\"\");\r\n  };\r\n\r\n  const onSubmit = (e) => {\r\n    e.preventDefault();\r\n    // console.log(website, url, props.currWidget);\r\n    onHide();\r\n    props.addLinkToWidget(website, url, props.currWidget);\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      {...props}\r\n      onHide={onHide}\r\n      size=\"lg\"\r\n      aria-labelledby=\"contained-modal-title-vcenter\"\r\n      centered\r\n    >\r\n      <Modal.Header closeButton>\r\n        <Modal.Title id=\"contained-modal-title-vcenter\">\r\n          Add to {props.currWidget}\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={onSubmit}>\r\n          <Form.Group controlId=\"websiteName\">\r\n            <Form.Label>Website name</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"\"\r\n              value={website}\r\n              onChange={(e) => setWebsite(e.target.value)}\r\n            />\r\n          </Form.Group>\r\n\r\n          <Form.Group controlId=\"url\">\r\n            <Form.Label>URL</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"\"\r\n              value={url}\r\n              onChange={(e) => setUrl(e.target.value)}\r\n            />\r\n          </Form.Group>\r\n          <Button variant=\"primary\" type=\"submit\">\r\n            Save\r\n          </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nconst Dashboard = () => {\r\n  const user = useContext(UserContext);\r\n  const [modalShow, setModalShow] = React.useState(false);\r\n  const [currWidget, setCurrWidget] = React.useState(\"\");\r\n  const [showWidgetModal, setShowWidgetModal] = useState(false);\r\n  const [widgets, setWidgets] = React.useState([]);\r\n  const [recents, setRecents] = useState([]);\r\n\r\n  // const [widgets, setWidgets] = React.useState([\r\n  //   {\r\n  //     title: \"Classes\",\r\n  //     links: [\r\n  //       { url: \"sp21.datastructur.es\", name: \"CS61B\" },\r\n  //       {\r\n  //         url:\r\n  //           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\r\n  //         name: \"Cubstart\",\r\n  //       },\r\n  //       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\r\n  //     ],\r\n  //   },\r\n  //   {\r\n  //     title: \"Favorites\",\r\n  //     links: [\r\n  //       { url: \"sp21.datastructur.es\", name: \"weird link\" },\r\n  //       {\r\n  //         url:\r\n  //           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\r\n  //         name: \"Cubstart\",\r\n  //       },\r\n  //       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\r\n  //     ],\r\n  //   },\r\n  // ]);\r\n  // const [recents, setRecents] = useState([\r\n  //   {\r\n  //     title: \"Youtube\",\r\n  //     url: \"https://www.youtube.com\",\r\n  //   },\r\n  //   {\r\n  //     title:\r\n  //       \"Netflix test test test test test test test test test test test test test test test test test test test test test test test test test test\",\r\n  //     url: \"https://www.netflix.com\",\r\n  //   },\r\n  //   {\r\n  //     title: \"Google\",\r\n  //     url: \"https://www.google.com\",\r\n  //   },\r\n  // ]);\r\n\r\n  //UNCOMMENT FOR CHROME EXTENSION\r\n  useEffect(() => {\r\n    chrome.history.search({ text: \"\", maxResults: 20 }, function (data) {\r\n      const updated = [];\r\n      data.forEach(function (page) {\r\n        if (page.title) {\r\n          updated.push({ title: page.title, url: page.url });\r\n        }\r\n      });\r\n      setRecents(updated);\r\n    });\r\n  }, []);\r\n\r\n  const userEmail = user?.email?.replace(\"@\", \"%40\"); //\"charlesming2002%40gmail.com\"\r\n\r\n  const fetchWidgets = async (user) => {\r\n    const response = db.collection(\"users\").doc(user.displayName);\r\n    const data = await response.get();\r\n    const w = await data.data().widgets;\r\n    setWidgets(w);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchWidgets(user);\r\n    }\r\n  }, [user]);\r\n\r\n  const addLinkToWidget = (website, url, widgetName) => {\r\n    const toEdit = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    console.log(\"159\", widgets, toEdit);\r\n    if (!url.startsWith(\"https://\")) {\r\n      url = \"https://\" + url;\r\n    }\r\n    toEdit.links.push({ url: url, name: website });\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    addLinkFirebase(widgetName, website, url); //sync firebase\r\n  };\r\n\r\n  const removeLinkFromWidget = (widgetName, url) => {\r\n    const widget = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    widget.links = widget.links.filter((obj) => {\r\n      return obj.url !== url;\r\n    });\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    deleteLinkFirebase(widgetName, url); //sync firebase\r\n  };\r\n\r\n  const openModal = (widgetName) => {\r\n    setModalShow(true);\r\n    setCurrWidget(widgetName); //sync firebase\r\n  };\r\n\r\n  const openWidgetModal = () => {\r\n    setShowWidgetModal(true);\r\n  };\r\n\r\n  const addWidgetToDashboard = (title) => {\r\n    const old = widgets.map((obj) => obj);\r\n    old.push({ title: title, links: [] });\r\n    setWidgets(old);\r\n    addWidgetFirebase(title); //sync firebase\r\n  };\r\n\r\n  const deleteWidget = (widgetName) => {\r\n    const newState = widgets.filter((obj) => {\r\n      return obj.title !== widgetName;\r\n    });\r\n    setWidgets(newState);\r\n    deleteWidgetFirebase(widgetName);\r\n  };\r\n\r\n  const changeWidgetTitle = (widgetName, newWidgetTitle) => {\r\n    const widget = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    widget.title = newWidgetTitle;\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    changeWidgetTitleFirebase(widgetName, newWidgetTitle);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {user ? (\r\n        <>\r\n          <div className=\"dashboard-grid\">\r\n            {widgets.map((widget) => (\r\n              <Widget\r\n                title={widget.title}\r\n                links={widget.links}\r\n                openModal={openModal}\r\n                removeLink={removeLinkFromWidget}\r\n                deleteWidget={deleteWidget}\r\n                changeWidgetTitle={changeWidgetTitle}\r\n                isActive={currWidget === widget.title}\r\n                onClick={() => {\r\n                  setCurrWidget(widget.title);\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n          <div className=\"dashboard-grid2\">\r\n            <div className=\"widget2\">\r\n              <div className=\"widget-header\">\r\n                <div className=\"widget-title\">Recents</div>\r\n                <div className=\"widget-control\">\r\n                  <button\r\n                    class=\"btn btn-secondary btn-sm action-button\"\r\n                    onClick={() => {\r\n                      chrome.history.search(\r\n                        { text: \"\", maxResults: 20 },\r\n                        function (data) {\r\n                          const updated = [];\r\n                          data.forEach(function (page) {\r\n                            if (page.title) {\r\n                              updated.push({\r\n                                title: page.title,\r\n                                url: page.url,\r\n                              });\r\n                            }\r\n                          });\r\n                          setRecents(updated);\r\n                        }\r\n                      );\r\n                    }}\r\n                  >\r\n                    refresh\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"widget-grid\" id=\"recents\">\r\n                {recents.map((recent) => (\r\n                  <div className=\"widget-link\">\r\n                    <a\r\n                      href={recent.url}\r\n                      target=\"_blank\"\r\n                      className=\"classes-link\"\r\n                    >\r\n                      {recent.title}\r\n                    </a>\r\n                    {currWidget ? (\r\n                      <button\r\n                        class=\"btn btn-success btn-xs\"\r\n                        onClick={() => {\r\n                          if (currWidget) {\r\n                            addLinkToWidget(\r\n                              recent.title,\r\n                              recent.url,\r\n                              currWidget\r\n                            );\r\n                          }\r\n                        }}\r\n                      >\r\n                        +\r\n                      </button>\r\n                    ) : null}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            <div className=\"widget2\">\r\n              <div className=\"widget-header\">\r\n                <div className=\"widget-title\">Calendar</div>\r\n              </div>\r\n              <iframe\r\n                src={\r\n                  \"https://www.google.com/calendar/embed?src=\" +\r\n                  userEmail +\r\n                  \"&ctz=America%2FLos_Angeles\"\r\n                }\r\n                title=\"calendar\"\r\n                width=\"600\"\r\n                height=\"400\"\r\n                frameborder=\"0\"\r\n                scrolling=\"no\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"addWidgetContainer\">\r\n            <button\r\n              class=\"addWidgetButton\"\r\n              type=\"button\"\r\n              class=\"btn btn-primary\"\r\n              onClick={() => openWidgetModal()}\r\n            >\r\n              Add widget\r\n            </button>\r\n          </div>\r\n          <MyVerticallyCenteredModal\r\n            show={modalShow}\r\n            onHide={() => setModalShow(false)}\r\n            currWidget={currWidget}\r\n            addLinkToWidget={addLinkToWidget}\r\n          />\r\n          <AddWidgetModal\r\n            show={showWidgetModal}\r\n            onHide={() => setShowWidgetModal(false)}\r\n            addWidgetToDashboard={addWidgetToDashboard}\r\n          />\r\n        </>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}