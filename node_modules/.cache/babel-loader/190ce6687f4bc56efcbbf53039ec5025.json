{"ast":null,"code":"import _defineProperty from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*global chrome*/import React,{useState,useEffect,useContext}from\"react\";import{Modal,Button,Form}from\"react-bootstrap\";import Widget from\"./Widget\";import AddWidgetModal from\"./AddWidgetModal\";import{addWidget as addWidgetFirebase,deleteWidget as deleteWidgetFirebase,getWidgets as getWidgetsFirebase,addLinkToWidget as addLinkFirebase,editLink as editLinkFirebase,changeWidgetTitle as changeWidgetTitleFirebase,deleteLink as deleteLinkFirebase,db}from\"../scripts/login.js\";import{UserContext}from\"../providers/UserProvider\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function MyVerticallyCenteredModal(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),website=_useState2[0],setWebsite=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),url=_useState4[0],setUrl=_useState4[1];var onHide=function onHide(){props.onHide();setWebsite(\"\");setUrl(\"\");};var onSubmit=function onSubmit(e){e.preventDefault();// console.log(website, url, props.currWidget);\nonHide();props.addLinkToWidget(website,url,props.currWidget);};return/*#__PURE__*/_jsxs(Modal,_objectSpread(_objectSpread({},props),{},{onHide:onHide,size:\"lg\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsxs(Modal.Title,{id:\"contained-modal-title-vcenter\",children:[\"Add to \",props.currWidget]})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"websiteName\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Website name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"\",value:website,onChange:function onChange(e){return setWebsite(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"url\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"URL\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"\",value:url,onChange:function onChange(e){return setUrl(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Save\"})]})})]}));}var Dashboard=function Dashboard(){var _user$email,_jsx2;var user=useContext(UserContext);var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),modalShow=_React$useState2[0],setModalShow=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),currWidget=_React$useState4[0],setCurrWidget=_React$useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showWidgetModal=_useState6[0],setShowWidgetModal=_useState6[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),widgets=_React$useState6[0],setWidgets=_React$useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),recents=_useState8[0],setRecents=_useState8[1];// const [widgets, setWidgets] = React.useState([\n//   {\n//     title: \"Classes\",\n//     links: [\n//       { url: \"sp21.datastructur.es\", name: \"CS61B\" },\n//       {\n//         url:\n//           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\n//         name: \"Cubstart\",\n//       },\n//       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\n//     ],\n//   },\n//   {\n//     title: \"Favorites\",\n//     links: [\n//       { url: \"sp21.datastructur.es\", name: \"weird link\" },\n//       {\n//         url:\n//           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\n//         name: \"Cubstart\",\n//       },\n//       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\n//     ],\n//   },\n// ]);\n// const [recents, setRecents] = useState([\n//   {\n//     title: \"Youtube\",\n//     url: \"https://www.youtube.com\",\n//   },\n//   {\n//     title:\n//       \"Netflix test test test test test test test test test test test test test test test test test test test test test test test test test test\",\n//     url: \"https://www.netflix.com\",\n//   },\n//   {\n//     title: \"Google\",\n//     url: \"https://www.google.com\",\n//   },\n// ]);\n//UNCOMMENT FOR CHROME EXTENSION\n// useEffect(() => {\n//   chrome.history.search({ text: \"\", maxResults: 20 }, function (data) {\n//     const updated = [];\n//     data.forEach(function (page) {\n//       if (page.title && !updated.includes(page.title)) {\n//         updated.push({ title: page.title, url: page.url });\n//       }\n//     });\n//     setRecents(updated);\n//   });\n// }, []);\nvar userEmail=user===null||user===void 0?void 0:(_user$email=user.email)===null||_user$email===void 0?void 0:_user$email.replace(\"@\",\"%40\");//\"charlesming2002%40gmail.com\"\nvar fetchWidgets=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var response,data,w;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:response=db.collection(\"users\").doc(user.displayName);_context.next=3;return response.get();case 3:data=_context.sent;_context.next=6;return data.data().widgets;case 6:w=_context.sent;setWidgets(w);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchWidgets(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(user){fetchWidgets(user);}},[user]);var addLinkToWidget=function addLinkToWidget(website,url,widgetName){var toEdit=widgets.find(function(obj){return obj.title===widgetName;});console.log(\"159\",widgets,toEdit);if(!url.startsWith(\"https://\")){url=\"https://\"+url;}toEdit.links.push({url:url,name:website});var newState=widgets.map(function(obj){return obj;});setWidgets(newState);addLinkFirebase(widgetName,website,url);//sync firebase\n};var removeLinkFromWidget=function removeLinkFromWidget(widgetName,url){var widget=widgets.find(function(obj){return obj.title===widgetName;});widget.links=widget.links.filter(function(obj){return obj.url!==url;});var newState=widgets.map(function(obj){return obj;});setWidgets(newState);deleteLinkFirebase(widgetName,url);//sync firebase\n};var editLink=function editLink(widgetName,linkTitle,newTitle,newURL){var widget=widgets.find(function(obj){return obj.title===widgetName;});for(var i=0;i<widget.links.length;i++){if(widget.links[i].name===linkTitle){widget.links[i].name=newTitle;widget.links[i].url=newURL;}}var newState=widgets.map(function(obj){return obj;});setWidgets(newState);editLinkFirebase(widgetName,linkTitle,newTitle,newURL);};var openModal=function openModal(widgetName){setModalShow(true);setCurrWidget(widgetName);//sync firebase\n};var openWidgetModal=function openWidgetModal(){setShowWidgetModal(true);};var addWidgetToDashboard=function addWidgetToDashboard(title){var old=widgets.map(function(obj){return obj;});old.push({title:title,links:[]});setWidgets(old);addWidgetFirebase(title);//sync firebase\n};var deleteWidget=function deleteWidget(widgetName){var newState=widgets.filter(function(obj){return obj.title!==widgetName;});setWidgets(newState);deleteWidgetFirebase(widgetName);};var changeWidgetTitle=function changeWidgetTitle(widgetName,newWidgetTitle){var widget=widgets.find(function(obj){return obj.title===widgetName;});widget.title=newWidgetTitle;var newState=widgets.map(function(obj){return obj;});setWidgets(newState);changeWidgetTitleFirebase(widgetName,newWidgetTitle);};return/*#__PURE__*/_jsx(_Fragment,{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-grid\",children:widgets.map(function(widget){return/*#__PURE__*/_jsx(Widget,{title:widget.title,links:widget.links,openModal:openModal,removeLink:removeLinkFromWidget,deleteWidget:deleteWidget,changeWidgetTitle:changeWidgetTitle,isActive:currWidget===widget.title,onClick:function onClick(){setCurrWidget(widget.title);}});})}),/*#__PURE__*/_jsx(\"div\",{class:\"addWidgetContainer\",children:/*#__PURE__*/_jsx(\"button\",(_jsx2={class:\"addWidgetButton\",type:\"button\"},_defineProperty(_jsx2,\"class\",\"btn btn-primary\"),_defineProperty(_jsx2,\"onClick\",function onClick(){return openWidgetModal();}),_defineProperty(_jsx2,\"children\",\"Add widget\"),_jsx2))}),/*#__PURE__*/_jsx(MyVerticallyCenteredModal,{show:modalShow,onHide:function onHide(){return setModalShow(false);},currWidget:currWidget,addLinkToWidget:addLinkToWidget}),/*#__PURE__*/_jsx(AddWidgetModal,{show:showWidgetModal,onHide:function onHide(){return setShowWidgetModal(false);},addWidgetToDashboard:addWidgetToDashboard})]}):/*#__PURE__*/_jsx(_Fragment,{})});};export default Dashboard;","map":{"version":3,"sources":["C:/Users/EthanP/Documents/cubstart/tabulate/tab-ulate/src/components/Dashboard.js"],"names":["React","useState","useEffect","useContext","Modal","Button","Form","Widget","AddWidgetModal","addWidget","addWidgetFirebase","deleteWidget","deleteWidgetFirebase","getWidgets","getWidgetsFirebase","addLinkToWidget","addLinkFirebase","editLink","editLinkFirebase","changeWidgetTitle","changeWidgetTitleFirebase","deleteLink","deleteLinkFirebase","db","UserContext","MyVerticallyCenteredModal","props","website","setWebsite","url","setUrl","onHide","onSubmit","e","preventDefault","currWidget","target","value","Dashboard","user","modalShow","setModalShow","setCurrWidget","showWidgetModal","setShowWidgetModal","widgets","setWidgets","recents","setRecents","userEmail","email","replace","fetchWidgets","response","collection","doc","displayName","get","data","w","widgetName","toEdit","find","obj","title","console","log","startsWith","links","push","name","newState","map","removeLinkFromWidget","widget","filter","linkTitle","newTitle","newURL","i","length","openModal","openWidgetModal","addWidgetToDashboard","old","newWidgetTitle"],"mappings":"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","sourcesContent":["/*global chrome*/\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport { Modal, Button, Form } from \"react-bootstrap\";\r\n\r\nimport Widget from \"./Widget\";\r\nimport AddWidgetModal from \"./AddWidgetModal\";\r\nimport {\r\n  addWidget as addWidgetFirebase,\r\n  deleteWidget as deleteWidgetFirebase,\r\n  getWidgets as getWidgetsFirebase,\r\n  addLinkToWidget as addLinkFirebase,\r\n  editLink as editLinkFirebase,\r\n  changeWidgetTitle as changeWidgetTitleFirebase,\r\n  deleteLink as deleteLinkFirebase,\r\n  db,\r\n} from \"../scripts/login.js\";\r\nimport { UserContext } from \"../providers/UserProvider\";\r\n\r\nfunction MyVerticallyCenteredModal(props) {\r\n  const [website, setWebsite] = useState(\"\");\r\n  const [url, setUrl] = useState(\"\");\r\n\r\n  const onHide = () => {\r\n    props.onHide();\r\n    setWebsite(\"\");\r\n    setUrl(\"\");\r\n  };\r\n\r\n  const onSubmit = (e) => {\r\n    e.preventDefault();\r\n    // console.log(website, url, props.currWidget);\r\n    onHide();\r\n    props.addLinkToWidget(website, url, props.currWidget);\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      {...props}\r\n      onHide={onHide}\r\n      size=\"lg\"\r\n      aria-labelledby=\"contained-modal-title-vcenter\"\r\n      centered\r\n    >\r\n      <Modal.Header closeButton>\r\n        <Modal.Title id=\"contained-modal-title-vcenter\">\r\n          Add to {props.currWidget}\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={onSubmit}>\r\n          <Form.Group controlId=\"websiteName\">\r\n            <Form.Label>Website name</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"\"\r\n              value={website}\r\n              onChange={(e) => setWebsite(e.target.value)}\r\n            />\r\n          </Form.Group>\r\n\r\n          <Form.Group controlId=\"url\">\r\n            <Form.Label>URL</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              placeholder=\"\"\r\n              value={url}\r\n              onChange={(e) => setUrl(e.target.value)}\r\n            />\r\n          </Form.Group>\r\n          <Button variant=\"primary\" type=\"submit\">\r\n            Save\r\n          </Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nconst Dashboard = () => {\r\n  const user = useContext(UserContext);\r\n  const [modalShow, setModalShow] = React.useState(false);\r\n  const [currWidget, setCurrWidget] = React.useState(\"\");\r\n  const [showWidgetModal, setShowWidgetModal] = useState(false);\r\n  const [widgets, setWidgets] = React.useState([]);\r\n  const [recents, setRecents] = useState([]);\r\n\r\n  // const [widgets, setWidgets] = React.useState([\r\n  //   {\r\n  //     title: \"Classes\",\r\n  //     links: [\r\n  //       { url: \"sp21.datastructur.es\", name: \"CS61B\" },\r\n  //       {\r\n  //         url:\r\n  //           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\r\n  //         name: \"Cubstart\",\r\n  //       },\r\n  //       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\r\n  //     ],\r\n  //   },\r\n  //   {\r\n  //     title: \"Favorites\",\r\n  //     links: [\r\n  //       { url: \"sp21.datastructur.es\", name: \"weird link\" },\r\n  //       {\r\n  //         url:\r\n  //           \"https://www.notion.so/Cubstart-Intro-to-Building-Apps-d42282d66dd942c399b6ce87167889d6\",\r\n  //         name: \"Cubstart\",\r\n  //       },\r\n  //       { url: \"https://www.eecs70.org/\", name: \"CS70\" },\r\n  //     ],\r\n  //   },\r\n  // ]);\r\n  // const [recents, setRecents] = useState([\r\n  //   {\r\n  //     title: \"Youtube\",\r\n  //     url: \"https://www.youtube.com\",\r\n  //   },\r\n  //   {\r\n  //     title:\r\n  //       \"Netflix test test test test test test test test test test test test test test test test test test test test test test test test test test\",\r\n  //     url: \"https://www.netflix.com\",\r\n  //   },\r\n  //   {\r\n  //     title: \"Google\",\r\n  //     url: \"https://www.google.com\",\r\n  //   },\r\n  // ]);\r\n\r\n  //UNCOMMENT FOR CHROME EXTENSION\r\n  // useEffect(() => {\r\n  //   chrome.history.search({ text: \"\", maxResults: 20 }, function (data) {\r\n  //     const updated = [];\r\n  //     data.forEach(function (page) {\r\n  //       if (page.title && !updated.includes(page.title)) {\r\n  //         updated.push({ title: page.title, url: page.url });\r\n  //       }\r\n  //     });\r\n  //     setRecents(updated);\r\n  //   });\r\n  // }, []);\r\n\r\n  const userEmail = user?.email?.replace(\"@\", \"%40\"); //\"charlesming2002%40gmail.com\"\r\n\r\n  const fetchWidgets = async (user) => {\r\n    const response = db.collection(\"users\").doc(user.displayName);\r\n    const data = await response.get();\r\n    const w = await data.data().widgets;\r\n    setWidgets(w);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchWidgets(user);\r\n    }\r\n  }, [user]);\r\n\r\n  const addLinkToWidget = (website, url, widgetName) => {\r\n    const toEdit = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    console.log(\"159\", widgets, toEdit);\r\n    if (!url.startsWith(\"https://\")) {\r\n      url = \"https://\" + url;\r\n    }\r\n    toEdit.links.push({ url: url, name: website });\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    addLinkFirebase(widgetName, website, url); //sync firebase\r\n  };\r\n\r\n  const removeLinkFromWidget = (widgetName, url) => {\r\n    const widget = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    widget.links = widget.links.filter((obj) => {\r\n      return obj.url !== url;\r\n    });\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    deleteLinkFirebase(widgetName, url); //sync firebase\r\n  };\r\n\r\n  const editLink = (widgetName, linkTitle, newTitle, newURL) => {\r\n    const widget = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    for (let i = 0; i < widget.links.length; i++) {\r\n      if (widget.links[i].name === linkTitle) {\r\n        widget.links[i].name = newTitle;\r\n        widget.links[i].url = newURL;\r\n      }\r\n    }\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    editLinkFirebase(widgetName, linkTitle, newTitle, newURL);\r\n  }\r\n\r\n  const openModal = (widgetName) => {\r\n    setModalShow(true);\r\n    setCurrWidget(widgetName); //sync firebase\r\n  };\r\n\r\n  const openWidgetModal = () => {\r\n    setShowWidgetModal(true);\r\n  };\r\n\r\n  const addWidgetToDashboard = (title) => {\r\n    const old = widgets.map((obj) => obj);\r\n    old.push({ title: title, links: [] });\r\n    setWidgets(old);\r\n    addWidgetFirebase(title); //sync firebase\r\n  };\r\n\r\n  const deleteWidget = (widgetName) => {\r\n    const newState = widgets.filter((obj) => {\r\n      return obj.title !== widgetName;\r\n    });\r\n    setWidgets(newState);\r\n    deleteWidgetFirebase(widgetName);\r\n  };\r\n\r\n  const changeWidgetTitle = (widgetName, newWidgetTitle) => {\r\n    const widget = widgets.find((obj) => {\r\n      return obj.title === widgetName;\r\n    });\r\n    widget.title = newWidgetTitle;\r\n    const newState = widgets.map((obj) => obj);\r\n    setWidgets(newState);\r\n    changeWidgetTitleFirebase(widgetName, newWidgetTitle);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {user ? (\r\n        <>\r\n          <div className=\"dashboard-grid\">\r\n            {widgets.map((widget) => (\r\n              <Widget\r\n                title={widget.title}\r\n                links={widget.links}\r\n                openModal={openModal}\r\n                removeLink={removeLinkFromWidget}\r\n                deleteWidget={deleteWidget}\r\n                changeWidgetTitle={changeWidgetTitle}\r\n                isActive={currWidget === widget.title}\r\n                onClick={() => {\r\n                  setCurrWidget(widget.title);\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n          {/* <div className=\"dashboard-grid2\">\r\n            <div className=\"widget2\">\r\n              <div className=\"widget-header\">\r\n                <div className=\"widget-title\">Recents</div>\r\n                <div className=\"widget-control\">\r\n                  <button\r\n                    class=\"btn btn-secondary btn-sm action-button\"\r\n                    onClick={() => {\r\n                      chrome.history.search(\r\n                        { text: \"\", maxResults: 20 },\r\n                        function (data) {\r\n                          const updated = [];\r\n                          data.forEach(function (page) {\r\n                            if (page.title) {\r\n                              updated.push({\r\n                                title: page.title,\r\n                                url: page.url,\r\n                              });\r\n                            }\r\n                          });\r\n                          setRecents(updated);\r\n                        }\r\n                      );\r\n                    }}\r\n                  >\r\n                    refresh\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"widget-grid\" id=\"recents\">\r\n                {recents.map((recent) => (\r\n                  <div className=\"widget-link\">\r\n                    <a\r\n                      href={recent.url}\r\n                      target=\"_blank\"\r\n                      className=\"classes-link\"\r\n                    >\r\n                      {recent.title}\r\n                    </a>\r\n                    {currWidget ? (\r\n                      <button\r\n                        class=\"btn btn-success btn-xs\"\r\n                        onClick={() => {\r\n                          if (currWidget) {\r\n                            addLinkToWidget(\r\n                              recent.title,\r\n                              recent.url,\r\n                              currWidget\r\n                            );\r\n                          }\r\n                        }}\r\n                      >\r\n                        +\r\n                      </button>\r\n                    ) : null}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            <div className=\"widget2\">\r\n              <div className=\"widget-header\">\r\n                <div className=\"widget-title\">Calendar</div>\r\n              </div>\r\n              <iframe\r\n                src={\r\n                  \"https://www.google.com/calendar/embed?src=\" +\r\n                  userEmail +\r\n                  \"&ctz=America%2FLos_Angeles\"\r\n                }\r\n                title=\"calendar\"\r\n                width=\"600\"\r\n                height=\"400\"\r\n                frameborder=\"0\"\r\n                scrolling=\"no\"\r\n              />\r\n            </div>\r\n          </div> */}\r\n          <div class=\"addWidgetContainer\">\r\n            <button\r\n              class=\"addWidgetButton\"\r\n              type=\"button\"\r\n              class=\"btn btn-primary\"\r\n              onClick={() => openWidgetModal()}\r\n            >\r\n              Add widget\r\n            </button>\r\n          </div>\r\n          <MyVerticallyCenteredModal\r\n            show={modalShow}\r\n            onHide={() => setModalShow(false)}\r\n            currWidget={currWidget}\r\n            addLinkToWidget={addLinkToWidget}\r\n          />\r\n          <AddWidgetModal\r\n            show={showWidgetModal}\r\n            onHide={() => setShowWidgetModal(false)}\r\n            addWidgetToDashboard={addWidgetToDashboard}\r\n          />\r\n        </>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}